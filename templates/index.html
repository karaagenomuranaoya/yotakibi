{% extends "layout.html" %}

{% block content %}
<div class="fire-starter">
    <h1 class="logo">å¤œç„šãç«</h1>
    <p class="intro">
        ã‚ãªãŸã®è¨€è‘‰ã‚’è–ªã¨ã—ã¦ç„šã¹ã‚‹ã¨ã€<br>
        èª°ã‹ãŒç¯ã—ãŸç«ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
    </p>

    <form action="{{ url_for('write') }}" method="POST" class="diary-form" novalidate>
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

        <div class="form-group">
            <label for="content">è–ªï¼ˆä»Šæ—¥ã®è¨€è‘‰ï¼‰</label>
            <textarea name="content" id="content" rows="6" placeholder="ç‹¬ã‚Šã®å¤œã‚‚æ‚ªããªã„ã€‚"
                required>{{ kept_content if kept_content else '' }}</textarea>
        </div>

        <div class="form-group">
            <label for="aikotoba">ç¨®ç«</label>

            <div style="display: flex; gap: 0.5rem; align-items: center;">
                <input type="text" name="aikotoba" id="aikotoba" placeholder="ãã‚‡ã†ã®ãŸã­ã³" required autocomplete="off"
                    style="flex: 1;">

                <button type="button" onclick="generateRandomKey()"
                    style="background: none; border: 1px solid #5C4A3D; color: #D4AF37; padding: 0.5rem 1rem; cursor: pointer; border-radius: 4px; font-size: 0.9rem;">
                    ğŸ² ç”Ÿæˆ
                </button>
            </div>

            <span class="hint">
                ç¨®ç«ï¼ˆåˆè¨€è‘‰ï¼‰ã‚’æ±ºã‚ã¾ã—ã‚‡ã†ã€‚<br>
                ã€Œã­ã“ã€ã€Œç©ºã€ã®ã‚ˆã†ãªç°¡å˜ãªè¨€è‘‰ã¯ã€å¶ç„¶èª°ã‹ã¨é‡ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚<br>
                è‡ªåˆ†ã ã‘ã®ç§˜å¯†ã«ã—ãŸã„å ´åˆã¯ã€<strong>ç”Ÿæˆãƒœã‚¿ãƒ³</strong>ã‚’æŠ¼ã—ã¦ã€ã‚ãªãŸã ã‘ã®ç‰¹åˆ¥ãªç«ã‚’ä½œã£ã¦ãã ã•ã„ã€‚
            </span>

            <div class="checkbox-group">
                <input type="checkbox" name="is_public" id="is_public" value="1">
                <label for="is_public" class="checkbox-label">
                    ã“ã®ç¨®ç«ã‚’ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã«è¡¨ç¤ºã™ã‚‹<br>
                    <span style="font-size: 0.8rem; opacity: 0.7;">
                        â€»ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨ã€åŒã˜ç¨®ç«ã‚’ä½¿ã£ã¦ã„ã‚‹ã“ã¨ãŒä»–ã®äººã«åˆ†ã‹ã‚Šã¾ã™ã€‚<br>
                        ï¼ˆè‡ªåˆ†ã ã¨æ°—ã¥ã‹ã‚ŒãŸããªã„å ´åˆã¯å¤–ã—ã¦ãã ã•ã„ï¼‰
                    </span>
                </label>
            </div>
        </div>

        <button type="submit" class="btn-burn">ç«ã‚’ç„šã¹ã‚‹</button>
    </form>
    <div class="write-back-nav">
        <a href="{{ url_for('index') }}" class="write-back-link">
            &lt; ç„šãç«ã«æˆ»ã‚‹
        </a>
    </div>

    <style>
        .write-back-nav {
            margin-top: 2rem;
            text-align: center;
        }

        .write-back-link {
            display: inline-block;
            color: #E0D6C8;
            /* æ˜ã‚‹ã„æ–‡å­—è‰² */
            border: 1px solid #5C4A3D;
            /* æ ç·šã‚’ã¤ã‘ã‚‹ */
            padding: 0.6rem 2rem;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.9rem;
            background: rgba(0, 0, 0, 0.3);
            /* å°‘ã—èƒŒæ™¯ã‚’æš—ãã—ã¦æ–‡å­—ã‚’æµ®ãç«‹ãŸã›ã‚‹ */
            transition: all 0.3s ease;
        }

        .write-back-link:hover {
            border-color: #D4AF37;
            /* ãƒ›ãƒãƒ¼ã§æ ã‚’é‡‘è‰²ã« */
            color: #D4AF37;
            /* æ–‡å­—ã‚‚é‡‘è‰²ã« */
            background: rgba(44, 36, 27, 0.8);
        }
    </style>
</div>

<script>
    function generateRandomKey() {
        // ãƒ©ãƒ³ãƒ€ãƒ ãªè‹±æ•°å­—10æ–‡å­—ã‚’ç”Ÿæˆ
        const chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        let result = "";
        for (let i = 0; i < 12; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }

        // å…¥åŠ›æ¬„ã«ã‚»ãƒƒãƒˆ
        const input = document.getElementById('aikotoba');
        input.value = result;

        // ç”Ÿæˆã—ãŸã“ã¨ãŒã‚ã‹ã‚‹ã‚ˆã†ã«å°‘ã—ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼ˆç‚¹æ»…ï¼‰
        input.style.backgroundColor = "#5C4A3D";
        setTimeout(() => {
            input.style.backgroundColor = "#3E3228";
        }, 200);
    }
</script>
{% endblock %}